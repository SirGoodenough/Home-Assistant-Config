- sensor:
  - unique_id: lock_back_door_mode
    attributes:
      friendly_name: "Lock Back Door Mode"
    icon: >-
      {% if is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "21") %}
        mdi:lock-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "22") %}
        mdi:lock-open-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "26") %}
        mdi:lock
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "27") %}
        mdi:lock
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "17") %}
        mdi:lock-alert-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "18") %}
        mdi:account-lock-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "19") %}
        mdi:account-lock-open-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "23") %}
        mdi:emoticon-dead
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "24") %}
        mdi:lock
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "25") %}
        mdi:lock-open
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "112") %}
        mdi:lock-plus
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "32") %}
        mdi:lock-remove
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "161") %}
        mdi:lock-alert-outline
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "162") %}
        mdi:lock-alert
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "167") %}
        mdi:battery-30
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "168") %}
        mdi:battery-10
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "169") %}
        mdi:battery-alert-variant
      {% else %}
        mdi:cancel
      {% endif %}
    state: >-
      {% if is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "21") %}
        Manual Lock
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "22") %}
        Manual Unlock
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "26") %}
        Auto Jammed
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "27") %}
        Auto Locked
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "17") %}
        Keypad Jammed
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "18") %}
        {% if is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 1) %}
          Locked by House
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 2) %}
          Locked by Dad
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 3) %}
          Locked by Mom
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 4) %}
          Locked by Carol
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 5) %}
          Locked by Bill
        {% else %}
          "Unknown Code Lock " {{ states('sensor.smart_code_with_home_connect_technology_alarmlevel') }}
        {% endif %}
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "19") %}
        {% if is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 1) %}
          Unlocked by House
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 2) %}
          Unlocked by Dad
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 3) %}
          Unlocked by Mom
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 4) %}
          Unlocked by Carol
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 5) %}
          Unlocked by Bill
        {% else %}
          "Unknown Code Lock " {{ states('sensor.smart_code_with_home_connect_technology_alarmlevel') }}
        {% endif %}
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "23") %}
        Controller Jammed
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "24") %}
        Controller Locked
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "25") %}
        Controller Opened
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "112") %}
        New User Code " {{ states('sensor.smart_code_with_home_connect_technology_alarmlevel') }}
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "32") %}
        All User Codes deleted
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "161") %}
        Failed User Code attempt
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "162") %}
        {% if is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 1) %}
          Locked by House
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 2) %}
          Locked by Dad
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 3) %}
          Locked by Mom
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 4) %}
          Locked by Carol
        {% elif is_state("sensor.smart_code_with_home_connect_technology_alarmlevel", 5) %}
          Locked by Bill
        {% else %}
          Unknown Code Lock " {{ states('sensor.smart_code_with_home_connect_technology_alarmlevel') }}
        {% endif %}
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "167") %}
        Low battery level
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "168") %}
        Critical battery level
      {% elif is_state("ensor.smart_code_with_home_connect_technology_alarmtype", "169") %}
        Battery level too low to operate lock
      {% else %}
        {{ states("ensor.smart_code_with_home_connect_technology_alarmtype") }}
      {% endif %}

##### Kwikset Lock Alarm Codes:
##### source:
  ##### http://s7d5.scene7.com/is/content/BDHHI/ApplicationNote-UsingASCII-Z-Wave-Locks
# 021 001 Lock Secured using Keyed cylinder or inside thumb-turn
# 022 001 Lock Un-Secured using Keyed cylinder or inside thumb-turn
# 026 001 Lock Auto Secured – Bolt Jammed (Not fully extended)
# 027 001 Lock Auto Secured – Successful (Fully extended)
# 017 001 Lock Secured at Keypad – Bolt Jammed (Not fully extended)
# 018 000 or User-ID#* Lock Secured at Keypad – Successful (Fully extended)
# 019 User-ID#* Lock Un-Secured by User (User-ID) at Keypad
# 023 001 Lock Secured by Controller – Bolt Jammed (Not fully extended)
# 024 001 Lock Secured by Controller – Successful (Fully extended)
# 025 001 Lock Un-Secured by Controller – Successful (Fully retracted)
# 112 User-ID#* New User Code (User-ID#) added to the lock
# 032 001 All User Codes deleted from lock
# 161 001 Failed User Code attempt at Keypad
# 162 User-ID#* Attempted access by user (User-ID#) outside of scheduled
# 167 001 Low battery level
# 168 001 Critical battery level
# 169 001 Battery level too low to operate lock

