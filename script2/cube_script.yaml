cube_dimmer_control:
  description: Template Dimmer Control
  variables:
    light:
    angle:
  sequence:
    - service: light.turn_on
      data_template:
        entity_id: "{{ light }}"
        brightness_pct: >
          {% set step_size = angle * 0.4 %}
          {% set cb = (state_attr( light, 'brightness') | float(10) / 255.0) * 100.0 %}
          {% set new_brightness = cb | int(10) + step_size %}
          {% if cb < 5 %} 
            0
          {% elif new_brightness <= 10 %} 
            10
          {% elif 91 <= new_brightness < (90 + step_size) %}
            100
          {% else %}
            {{ new_brightness }}
          {% endif %}
