cube_dimmer_control:
  description: Template Dimmer Control
  variables:
    light:
    angle:
  sequence:
    - service: light.turn_on
      data_template:
        entity_id: "{{ light }}"
        brightness_pct: >
          {% set step_size = angle * 0.4 %}
          {% set cb = (state_attr( light, 'brightness') | float(10) / 255.0) * 100.0 %}
          {% set new_brightness = cb | int(10) + step_size %}
          {% if cb < 5 %} 
            0
          {% elif new_brightness <= 10 %} 
            10
          {% elif 91 <= new_brightness < (90 + step_size) %}
            100
          {% else %}
            {{ new_brightness }}
          {% endif %}

cube_red_color_control:
  description: Control the red part of the color
  variables:
    light:
    angle:
  sequence:
    - service: light.turn_on
      data_template:
        entity_id: "{{ light }}"
        rgb_color: >
          {% set step_size = angle * 0.6 %}
          {% set color = state_attr(light, 'rgb_color') %}
          {% set R = color[0] %}
          {% set B = color[1] %}
          {% set G = color[2] %}
          {% set new_red = R + step_size | int(0) %}
          {% if new_red < 0 %} 
            {{ 0, B, G }}
          {% elif new_red > 255 %}
            {{ 255, B, G }}
          {% else %}
            {{ new_red, B, G }}
          {% endif %}

cube_green_color_control:
  description: Control the green part of the color
  variables:
    light:
    angle:
  sequence:
    - service: light.turn_on
      data_template:
        entity_id: "{{ light }}"
        rgb_color: >
          {% set step_size = angle * 0.6 %}
          {% set color = state_attr(light, 'rgb_color') %}
          {% set R = color[0] %}
          {% set G = color[1] %}
          {% set B = color[2] %}
          {% set new_green = G + step_size | int(0) %}
          {% if new_green < 0 %} 
            {{ R, 0, B }}
          {% elif new_green > 255 %}
            {{ R, 255, B }}
          {% else %}
            {{ R, new_green, B }}
          {% endif %}

cube_blue_color_control:
  description: Control the blue part of the color
  variables:
    light:
    angle:
  sequence:
    - service: light.turn_on
      data_template:
        entity_id: "{{ light }}"
        rgb_color: >
          {% set step_size = angle * 0.6 %}
          {% set color = state_attr(light, 'rgb_color') %}
          {% set R = color[0] %}
          {% set G = color[1] %}
          {% set B = color[2] %}
          {% set new_blue = B + step_size | int(0) %}
          {% if new_blue < 0 %} 
            {{ R, G, 0 }}
          {% elif new_blue > 255 %}
            {{ R, G, 255 }}
          {% else %}
            {{ R, G, new_blue }}
          {% endif %}
