blueprint:
  name: TTS Cloud Message_experimental
  description: A script that uses tts-cloud via Nabu-Casa to send a message to a google
    speaker
#  source_url: https://gist.github.com/SirGoodenough/7eea35ad75daf883a7938c0bc99499bd
  domain: script
  homeassistant:
    min_version: 2021.11.0
  input:
    speaker_target:
      name: Device(s) to speak thru
      description: This uses tts-cloud and will only work when using Nabu-Casa
      selector:
        entity:
          domain: media_player
    announcement_message:
      name: Spoken message
      description: Type your message here
      default: It matters not what I say.
      selector:
        text:
          multiline: true
    speaker_gender:
      name: Speaker Gender
      description: Select speaker gender male or female
      default: male
      selector:
        select:
          options:
          - female
          - male
    speaker_language:
      name: Speaker Language
      description: 'Select Language code.  See-> (https://www.nabucasa.com/config/tts/)
        This defaults to en=US (english/US) so you do not have to send the data from the
        calling script if you don''t need to change it.  
        NOTE: It is possible that not all Languages can give you both Genders.'
      default: en-AU
      selector:
        select:
          options:
          - ar-EG
          - ar-SA
          - bg-BG
          - ca-ES
          - zh-HK
          - zh-CN
          - zh-TW
          - hr-HR
          - cs-CZ
          - da-DK
          - nl-NL
          - en-AU
          - en-CA
          - en-IN
          - en-IE
          - en-GB
          - en-US
          - fi-FI
          - fr-CA
          - fr-FR
          - fr-CH
          - de-AT
          - de-DE
          - de-CH
          - el-GR
          - he-IL
          - hi-IN
          - hu-HU
          - id-ID
          - it-IT
          - ja-JP
          - ko-KR
          - ms-MY
          - nb-NO
          - pl-PL
          - pt-BR
          - pt-PT
          - ro-RO
          - ru-RU
          - sk-SK
          - sl-SI
          - es-MX
          - es-ES
          - sv-SE
          - ta-IN
          - te-IN
          - th-TH
          - tr-TR
          - vi-VN
mode: queued
variables:
  speaker_target_ent: !input 'speaker_target'
sequence:
  - choose:
      - conditions:
          condition: not
          conditions:
            - condition: state
              entity_id: !input 'speaker_target'
              state: 'Playing'
        sequence:
          - service: media_player.volume_mute
            data:
              entity_id: !input 'speaker_target'
              is_volume_muted: true
          - service: media_player.turn_on
            target:
              entity_id: !input 'speaker_target'
    default:
      - service: media_player.volume_mute
        data:
          entity_id: !input 'speaker_target'
          is_volume_muted: false
      - service: tts.cloud_say
        data:
          entity_id: !input 'speaker_target'
          message: !input 'announcement_message'
          options:
            gender: !input 'speaker_gender'
          language: !input 'speaker_language'
